---
- name: create volume 1 gb
  command: openstack {{ keystone_auth }} volume create --size {{ VOLUME_SIZE }} {{ VOLUME_NAME }}

- name: retry to attach volume to VM until VM is running
  command: openstack  {{ keystone_auth }} server add volume {{ VM_NAME }} {{ VOLUME_NAME }}
  register: result
  until: result.failed == false
  retries: 5
  delay: "{{ WAIT_TIME }}"

#- name: print attach volume log
#  debug:
#    var: result
